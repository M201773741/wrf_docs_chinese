<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>WRFDA 算法的改进 | WRF 中文文档</title>
    <meta name="description" content="WRF 技术手册 第4版 中英对照文档">
    <meta name="generator" content="VuePress 1.4.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0-alpha/dist/katex.min.css">
  <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
  <script>
            var _hmt = _hmt || [];
            (function() {
                var hm = document.createElement("script");
                hm.src = "https://hm.baidu.com/hm.js?99a39314a1601be6f4aa0fb35ed29988";
                var s = document.getElementsByTagName("script")[0];
                s.parentNode.insertBefore(hm, s);
            })();
        </script>
    <meta property="article:published_time" content="2020-03-24T00:00:00.000Z"><meta property="article:modified_time" content="2020-03-26T10:29:41.000Z"><meta property="og:site_name" content="WRF 中文文档"><meta property="og:title" content="WRFDA 算法的改进"><meta property="og:description" content="WRF 技术手册 第4版 中英对照文档"><meta property="og:type" content="website"><meta property="og:url" content="/wrf_technote/11.2%20Improvements%20to%20the%20WRFDA%20Algorithm.html"><meta name="twitter:title" content="WRFDA 算法的改进"><meta name="twitter:description" content="WRF 技术手册 第4版 中英对照文档"><meta name="twitter:url" content="/wrf_technote/11.2%20Improvements%20to%20the%20WRFDA%20Algorithm.html"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:label1" content="Written by"><meta name="twitter:label2" content="Filed under"><meta name="twitter:data2" content="translate, WRF"><meta property="article:tag" content="translate"><meta property="article:tag" content="WRF">
    <link rel="preload" href="/wrf/assets/css/0.styles.014f0854.css" as="style"><link rel="preload" href="/wrf/assets/js/app.22a32cd3.js" as="script"><link rel="preload" href="/wrf/assets/js/4.5baa2a83.js" as="script"><link rel="preload" href="/wrf/assets/js/1.dd1b2a2d.js" as="script"><link rel="preload" href="/wrf/assets/js/19.f5085d4a.js" as="script"><link rel="prefetch" href="/wrf/assets/js/10.a0789d1f.js"><link rel="prefetch" href="/wrf/assets/js/11.360e73b5.js"><link rel="prefetch" href="/wrf/assets/js/12.688a0f31.js"><link rel="prefetch" href="/wrf/assets/js/13.e3435b3c.js"><link rel="prefetch" href="/wrf/assets/js/14.552e59be.js"><link rel="prefetch" href="/wrf/assets/js/15.0753b9d0.js"><link rel="prefetch" href="/wrf/assets/js/16.26c149ea.js"><link rel="prefetch" href="/wrf/assets/js/17.8024b874.js"><link rel="prefetch" href="/wrf/assets/js/18.3cc26db3.js"><link rel="prefetch" href="/wrf/assets/js/20.e2cdf72c.js"><link rel="prefetch" href="/wrf/assets/js/21.400b9a3f.js"><link rel="prefetch" href="/wrf/assets/js/22.404326d0.js"><link rel="prefetch" href="/wrf/assets/js/23.186c401f.js"><link rel="prefetch" href="/wrf/assets/js/24.ffb0be16.js"><link rel="prefetch" href="/wrf/assets/js/25.963bd9ff.js"><link rel="prefetch" href="/wrf/assets/js/26.559f26b1.js"><link rel="prefetch" href="/wrf/assets/js/27.bf9de55a.js"><link rel="prefetch" href="/wrf/assets/js/5.d3624f11.js"><link rel="prefetch" href="/wrf/assets/js/6.d1dcace9.js"><link rel="prefetch" href="/wrf/assets/js/7.e00a4866.js"><link rel="prefetch" href="/wrf/assets/js/8.2c349fa3.js"><link rel="prefetch" href="/wrf/assets/js/9.6116947b.js"><link rel="prefetch" href="/wrf/assets/js/vendors~flowchart.54960cef.js">
    <link rel="stylesheet" href="/wrf/assets/css/0.styles.014f0854.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div><div class="theme-container" data-v-319dd33c><div data-v-319dd33c><div id="loader-wrapper" class="loading-wrapper" data-v-4b73742e data-v-319dd33c data-v-319dd33c><div class="loader-main" data-v-4b73742e><div data-v-4b73742e></div><div data-v-4b73742e></div><div data-v-4b73742e></div><div data-v-4b73742e></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-1e2a0cc0 data-v-319dd33c data-v-319dd33c><h3 class="title" style="display:none;" data-v-1e2a0cc0 data-v-1e2a0cc0>WRF 中文文档</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-1e2a0cc0 data-v-1e2a0cc0><input type="password" value="" data-v-1e2a0cc0> <span data-v-1e2a0cc0>Konck! Knock!</span> <button data-v-1e2a0cc0>OK</button></label> <div class="footer" style="display:none;" data-v-1e2a0cc0 data-v-1e2a0cc0><span data-v-1e2a0cc0><i class="iconfont reco-theme" data-v-1e2a0cc0></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-1e2a0cc0>vuePress-theme-reco</a></span> <span data-v-1e2a0cc0><i class="iconfont reco-copyright" data-v-1e2a0cc0></i> <a data-v-1e2a0cc0><span data-v-1e2a0cc0>jokervTv</span>
            
          <span data-v-1e2a0cc0>2020 - </span>
          2020
        </a></span></div></div> <div class="hide" data-v-319dd33c><header class="navbar" data-v-319dd33c><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/wrf/" class="home-link router-link-active"><!----> <span class="site-name">WRF 中文文档</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      Contact
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/jokervTv" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="mailto:zhangyp6603@outlook.com" class="nav-link external"><i class="iconfont reco-mail"></i>
  Email
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://jokervtv.top/blog/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-bokeyuan"></i>
  博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <a href="https://github.com/jokervTv/wrf_docs_chinese" target="_blank" rel="noopener noreferrer" class="repo-link"><i class="iconfont reco-github"></i>
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask" data-v-319dd33c></div> <aside class="sidebar" data-v-319dd33c><div class="personal-info-wrapper" data-v-6c8ffc9c><!----> <h3 class="name" data-v-6c8ffc9c>
    jokervTv
  </h3> <div class="num" data-v-6c8ffc9c><div data-v-6c8ffc9c><h3 data-v-6c8ffc9c>13</h3> <h6 data-v-6c8ffc9c>文章</h6></div> <div data-v-6c8ffc9c><h3 data-v-6c8ffc9c>2</h3> <h6 data-v-6c8ffc9c>标签</h6></div></div> <hr data-v-6c8ffc9c></div> <nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      Contact
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/jokervTv" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="mailto:zhangyp6603@outlook.com" class="nav-link external"><i class="iconfont reco-mail"></i>
  Email
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://jokervtv.top/blog/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-bokeyuan"></i>
  博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <a href="https://github.com/jokervTv/wrf_docs_chinese" target="_blank" rel="noopener noreferrer" class="repo-link"><i class="iconfont reco-github"></i>
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>wrf_technote</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/wrf/wrf_technote/" class="sidebar-link">自述</a></li><li><a href="/wrf/wrf_technote/preface.html" class="sidebar-link">序言</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>简介</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/wrf/wrf_technote/1 Introduction.html" class="sidebar-link">简介</a></li><li><a href="/wrf/wrf_technote/1.1 Advanced Research WRF.html" class="sidebar-link">Advanced Research WRF (ARW)</a></li><li><a href="/wrf/wrf_technote/1.2 Major Features of the ARW System Version 4.html" class="sidebar-link">ARW系统第4版的主要功能</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>控制方程组</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/wrf/wrf_technote/2 Governing Equations.html" class="sidebar-link">控制方程组</a></li><li><a href="/wrf/wrf_technote/2.1 Vertical Coordinate and Flux-Form Variables.html" class="sidebar-link">垂直坐标和通量形式变量</a></li><li><a href="/wrf/wrf_technote/2.2 Flux-Form Euler Equation.html" class="sidebar-link">通量形式欧拉方程</a></li><li><a href="/wrf/wrf_technote/2.3 Map Projections, Coriolis and Curvature Terms.html" class="sidebar-link">地图投影，科里奥利和曲率项</a></li><li><a href="/wrf/wrf_technote/2.4 Perturbation Form of the Governing Equations.html" class="sidebar-link">控制方程的扰动形式</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>时间离散化</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/wrf/wrf_technote/3.1 Temporal Discretization.html" class="sidebar-link">模型离散化</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>数据同化</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/wrf/wrf_technote/11 Datra Assimilation.html" class="sidebar-link">数据同化</a></li><li><a href="/wrf/wrf_technote/11.1 Introduction.html" class="sidebar-link">简介</a></li><li><a href="/wrf/wrf_technote/11.2 Improvements to the WRFDA Algorithm.html" class="active sidebar-link">WRFDA 算法的改进</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wrf/wrf_technote/11.2 Improvements to the WRFDA Algorithm.html#_11-2-1-四维变分和预测对观测的敏感性" class="sidebar-link">11.2.1 四维变分和预测对观测的敏感性</a></li><li class="sidebar-sub-header"><a href="/wrf/wrf_technote/11.2 Improvements to the WRFDA Algorithm.html#_11-2-2-混合变分-集成技术" class="sidebar-link">11.2.2 混合变分/集成技术</a></li><li class="sidebar-sub-header"><a href="/wrf/wrf_technote/11.2 Improvements to the WRFDA Algorithm.html#_11-2-3-卫星辐射数据同化" class="sidebar-link">11.2.3 卫星辐射数据同化</a></li></ul></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-1e2a0cc0 data-v-319dd33c><h3 class="title" style="display:none;" data-v-1e2a0cc0 data-v-1e2a0cc0>WRFDA 算法的改进</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-1e2a0cc0 data-v-1e2a0cc0><input type="password" value="" data-v-1e2a0cc0> <span data-v-1e2a0cc0>Konck! Knock!</span> <button data-v-1e2a0cc0>OK</button></label> <div class="footer" style="display:none;" data-v-1e2a0cc0 data-v-1e2a0cc0><span data-v-1e2a0cc0><i class="iconfont reco-theme" data-v-1e2a0cc0></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-1e2a0cc0>vuePress-theme-reco</a></span> <span data-v-1e2a0cc0><i class="iconfont reco-copyright" data-v-1e2a0cc0></i> <a data-v-1e2a0cc0><span data-v-1e2a0cc0>jokervTv</span>
            
          <span data-v-1e2a0cc0>2020 - </span>
          2020
        </a></span></div></div> <div data-v-319dd33c><main class="page"><div class="page-title" style="display:none;"><h1>WRFDA 算法的改进</h1> <hr> <div data-v-484a899e><i class="iconfont reco-account" data-v-484a899e><span data-v-484a899e>jokervTv</span></i> <i class="iconfont reco-date" data-v-484a899e><span data-v-484a899e>2020-03-24</span></i> <!----> <i class="iconfont reco-tag tags" data-v-484a899e><span class="tag-item" data-v-484a899e>
      translate
    </span><span class="tag-item" data-v-484a899e>
      WRF
    </span></i></div></div> <div class="theme-reco-content content__default" style="display:none;"><p></p><div class="table-of-contents"><ul><li><a href="#_11-2-1-四维变分和预测对观测的敏感性">11.2.1 四维变分和预测对观测的敏感性</a></li><li><a href="#_11-2-2-混合变分-集成技术">11.2.2 混合变分/集成技术</a></li><li><a href="#_11-2-3-卫星辐射数据同化">11.2.3 卫星辐射数据同化</a></li></ul></div><p></p> <p>相对于 MM5 3DVAR 技术说明（Barker等人，2003）和 ARW 第 3 版技术说明（Skamarock等人，2008）中所述，WRFDA（V4）的最新版本进行了许多改进，其中包括四维变分（4D-Var）和混合变分/集合（Hybrid-EnVar）数据同化技术，卫星辐射的直接同化，雷达数据同化的改进以及其他新功能中对控制变量的更多选择。
这些将在下面简要概述，更多详细信息可以在引用的参考文献中找到。</p> <p>Relative to that described in the MM5 3DVAR technical note (Barker et al., 2003) and the ARW technical note Version 3 (Skamarock et al., 2008), the latest version of WRFDA (V4) contains a number of improvements, including four-dimensional variational (4D-Var) and hy- brid variational/ensemble (hybrid-EnVar) data assimilation techniques, the direct assimilation of satellite radiances, improvements on radar data assimilation, and more choices of control variables among other new capabilities. These will be briefly overviewed below and more details can be found in cited references.</p> <h2 id="_11-2-1-四维变分和预测对观测的敏感性"><a href="#_11-2-1-四维变分和预测对观测的敏感性" class="header-anchor">#</a> 11.2.1 四维变分和预测对观测的敏感性</h2> <p>4D-Var 的初始功能是在 WRFDA 3.1 中引入的（Huang 等，2009），Zhang 等人对此进行了进一步的改进（2013，2014年）。
WRFDA 4D-Var 允许使用 LBC 控制变量和 Jc-DFI（以控制重力波）。
4D-Var 模式下的 WRFDA 分析涉及在同化时间范围最小化过程中 ARW 的切线线性模型（TLM）的前向集成和 ARW 伴随模型（ADJ）的向后集成。
在 4.0 版中，WRFPlus 代码（即 WRF 的 TLM/ADJ）已完全集成到 WRF 主代码存储库中，这将简化将来的代码维护和开发。
虽然完整的 ARW 动力学的 TLM/ADJ（位于 WRF 源代码的 <code>wrftladj</code> 目录下）在 WRFPlus 代码中可用，但只有少数 WRF 物理方案具有相应的 TLM/ADJ，包括大规模冷凝和改良的 Kessler (温雨（Wang 等人，2013b) 方案，简化的积云参数化方案，垂直扩散和重力波阻力。
WRFPlus V4 尚未实现 ARW V4 的两个新功能（混合垂直坐标和湿势温度）中的 TLM/ADJ，但预计将在将来的版本中提供。
值得注意的是，自 3.4 版本以来，降水数据可以用 4D-Var 进行同化（Ban 等人，2017）。</p> <p>Initial capability of 4D-Var was introduced in WRFDA 3.1 (Huang et al., 2009), which has been further improved by Zhang et al. (2013, 2014a).
WRFDA 4D-Var allows the use of LBC control variables and Jc-DFI (to control the gravity wave).
WRFDA analysis in 4D-Var mode involves forward integration of the tangent linear model (TLM) and backward integration of the adjoint model (ADJ) of ARW during the minimization in the assimilation time window.
In Version 4.0, WRFPlus code (i.e., TLM/ADJ of WRF) is fully integrated into the WRF main code repository, which will ease future code maintenance and development.
While the TLM/ADJ (located under wrftladj directory of WRF source code) of the full ARW dynamics is available in WRFPlus code, only a few WRF physics schemes have corresponding TLM/ADJ, including the large-scale condensation and modified Kessler (warm-rain) (Wang et al., 2013b) scheme for microphysics, a simplified cumulus parameterization scheme, vertical diffusion, and gravity wave drag.
TLM/ADJ of the two new features in ARW V4, hybrid vertical coordinate and moist potential temperature, is not implemented yet in WRFPlus V4, but expected to be available in a future release.
It is worth noting that precipitation data can be assimilated with 4D-Var since version 3.4 (Ban et al., 2017).</p> <p>WRFDA 还引入了计算对观测值的预测敏感性（FSO）的功能（Zhang 等人，2015）。
FSO 允许使用 ARW 和 WRFDA 的伴随计算出不同观测值的预测影响。
请注意，在使用 WRFDA 计算 FSO 时，需要使用 Lanczos 最小化算法而不是共轭梯度法。</p> <p>The capability of computing the forecast sensitivity to observations (FSO) was also introduced in WRFDA (Zhang et al., 2015).
FSO allows the calculation of the forecast impact of different observations using the adjoint of ARW and WRFDA.
Notice that the Lanczos minimization algorithm instead of the Conjugate Gradient Method needs to be used when calculating FSO with WRFDA.</p> <h2 id="_11-2-2-混合变分-集成技术"><a href="#_11-2-2-混合变分-集成技术" class="header-anchor">#</a> 11.2.2 混合变分/集成技术</h2> <p>WRFDA 的 4D-Var 通过使用线性预测模型提供隐含的流相关的预测误差协方差，以在较短的时间范围内演变出扰动。
但是，这是有代价的。维护线性预测模型及其伴随物既需要计算资源，也需要人力资源。</p> <p>WRFDA’s 4D-Var provides implicitly flow-dependent forecast error covariance through the use of the linear forecast model to evolve perturbations through a short time window.
However, this comes at a cost; there are both computational as well as human resources required to maintain a linear forecast model and its adjoint.</p> <p>混合变分/集合数据同化尝试将集合数据同化的优点（流依赖性和灵活性）与变分系统的优点（同时处理观测值，动态/物理约束，复杂的质量控制，通过外循环处理非线性等）结合起来 ）。
WRFDA 混合算法（Wang等，2008a，b）采用了所谓的 α 控制变量公式，该公式首先在英国气象局实施。
WRFDA hybrid 可在3D（即 hybrid-3DEnVar）或 4D（即 hybrid-4DEnVar）模式下运行，并允许双分辨率配置（Schwartz等人，2015），即高分辨率的确定性背景和分析，以及较低分辨率的集合输入。</p> <p>Hybrid variational/ensemble data assimilation attempts to combine the benefits of ensemble data assimilation (flow dependence and flexibility) with those of variational systems (simultaneous treatment of observations, dynamical/physical constraints, complex quality control, treatment of nonlinearities via an outer loop, etc.).
The WRFDA hybrid algorithm (Wang et al.,2008a,b) adopts the so-called α control variable formulation, implemented first at UK MetOffice.
WRFDA hybrid can run in 3D (i.e., hybrid-3DEnVar) or 4D (i.e., hybrid-4DEnVar) mode and allows a dual-resolution configuration (Schwartz et al., 2015), i.e., the deterministic background and analysis at high resolution and ensemble input at lower resolution.</p> <p>值得注意的是，Hybrid-EnVar 算法使用由输入集形成的流相关的背景误差协方差来生成单个确定性分析，可以通过不同的方式获得该分析。
最简单的方法是从“第三方集合预测系统（EPS）（例如 NCEP 的全球集合预报系统（GEFS））获得集合输入。
在这种情况下，由于不需要运行自己的集合预测，因此可大大降低计算成本。
可以说，更好的方法是通过选择模型和分辨率来进行自己的集合分析和预测。
WRFDA 软件包包括一个程序，该程序执行集合变换卡尔曼滤波器（ETKF）以产生集合分析，然后可以生成集合预测并将其用作 WRFDA 混合分析的输入。
进行集合分析的另一种可能性是运行 WRFDA 混合 EnVar 集合，并对每个成员分析进行观察。</p> <p>It is worth noting that the hybrid-EnVar algorithm produces a single deterministic analysis with flow-dependent background error covariance formed by the ensemble input, which can be obtained in different ways.
The easiest way is to obtain the ensemble input from a “third-party” ensemble prediction system (EPS), e.g., NCEP’s Global Ensemble Forecast System (GEFS).
In that case, computational cost is significantly reduced because there is no need to run the own ensemble forecasts.
An arguably better way is to produce your own ensemble analysis and forecast with your choice of model and resolution.
The WRFDA package includes a program to perform the ensemble transform Kalman filter (ETKF) to produce the ensemble analysis and then ensemble forecasts can be generated and used as the input of the WRFDA hybrid analysis.
Another possibility of producing ensemble analyses is to run an ensemble of WRFDA hybrid-EnVar with perturbed observations for each member analysis.</p> <h2 id="_11-2-3-卫星辐射数据同化"><a href="#_11-2-3-卫星辐射数据同化" class="header-anchor">#</a> 11.2.3 卫星辐射数据同化</h2> <p>WRFDA 3.1 中引入了辐射数据同化功能（Liu 和 Barker，2006年）。
WRFDA 可以提取 NCEP GFS 模型中可操作的大多数 BUFR 格式辐射数据（HIRS，AMSU-A/B，MHS，AIRS，IASI，ATMS，SSMIS 和 SEVIRI）。
此外，还可以将 HDF 格式的 AMSR2 辐射数据（Yang等，2016）和 NETCDF 格式的 GOES-Imager 辐射数据（Yang 等，2017）同化。
WRFDA 系统的独特之处在于它与两种最广泛使用的快速辐射转移模型（RTM）交互：TOVS 的辐射转移（RTTOV）和社区辐射转移模型（CRTM），分别由欧洲气象卫星开发组织（EUMETSAT）和美国卫星数据同化联合中心（JCSDA）分别开发和维护。
到 RTTOV 和 CRTM 的灵活接口确保 WRFDA 用户可以从任何一个 RTM 可以模拟的传感器中吸收辐射数据，前提是已实施了相应的数据接口和质量控制。</p> <p>The capability of radiance data assimilation was introduced in WRFDA 3.1 (Liu and Barker, 2006).
Most of the BUFR format radiance data (HIRS, AMSU-A/B, MHS, AIRS, IASI, ATMS, SSMIS, and SEVIRI) used operationally in the NCEP’s GFS model can be ingested by WRFDA.
In addition, AMSR2 radiance data in HDF format (Yang et al., 2016) and GOES-Imager radiances in NETCDF format (Yang et al., 2017) can also be assimilated.
The WRFDA system is unique in that it interfaces to the two most widely used fast Radiative Transfer Models (RTMs): the Radiative Transfer for TOVS (RTTOV) and the Community Radiative Transfer Model (CRTM), developed and maintained by the European Organisation for the Exploitation of Meteorological Satellites (EUMETSAT) and the U.S. Joint Center for Satellite Data Assimilation (JCSDA), respectively.
A flexible interface to both RTTOV and CRTM ensures that WRFDA users can assimilate radiance data from all sensors that can be simulated by either RTM, provided that corresponding data interface and quality control have been implemented.</p> <p>卫星辐射测量和 RTMs 容易出现系统误差（即偏差），必须先进行校正才能吸收辐射。
偏差通常随平台，仪器，通道，扫描角度和大气条件而变化。
WRFDA 采用所谓的变分偏差校正（VarBC）算法进行自适应和在线辐射偏差校正，该方法将线性回归中的偏差校正系数更新为变分最小化的一部分（Dee，2004; Auligne et al。，2007）。
值得一提的是，WRFDA 中提供了离线 VarBC 功能，以生成偏差校正系数的统计数据，而无需运行实际的 WRFDA 分析，这在进行短期数据同化实验时非常有用（Liu 等人，2012）。</p> <p>Satellite radiance measurements and RTMs are prone to systematic errors (i.e., biases) that must be corrected before radiances can be assimilated.
Biases typically vary with platform, instrument, channel, scan angle, and atmospheric conditions.
WRFDA adopts the so-called variational bias correction (VarBC) algorithm for adaptive and online radiance bias correction, which updates the bias correction coefficients within the linear regression as a part of the variational minimization (Dee, 2004; Auligne et al., 2007).
It is worth mentioning that an offline VarBC functionality is provided within WRFDA to generate statistics for bias correction coefficients without running an actual WRFDA analysis, which is useful when conducting data assimilation experiments for a short period (Liu et al., 2012).</p> <p>对于晴空条件下的辐射同化，WRFDA 实施了两种先进的高光谱红外传感器云检测方法，如 AIRS 和 IASI（Xu 等人，2013年，2014年，2015年；Auligne，2014a，b），这可以实现同化在云层上方达到峰值的通道。
在 3.9 版中，随着对全天空数据的所谓“对称误差模型”的发展（Geer 和 Bauer，2011），引入了 AMSR2 辐射数据的全天空辐射同化功能（Yang 等，2016）。</p> <p>For radiance assimilation under clear-sky condition, two advanced cloud detection methods for hyperspectral infrared sensors such as AIRS and IASI were implemented in WRFDA (Xu et al., 2013, 2014, 2015; Auligne, 2014a,b), which allows the assimilation of the channels peaking above the cloud.
In version 3.9, all-sky radiance assimilation capability was introduced for AMSR2 radiance data (Yang et al., 2016) with the development of the so-called “symmetric error model” for all-sky data (Geer and Bauer, 2011).</p></div> <footer class="page-edit" style="display:none;"><div class="edit-link"><a href="https://github.com/jokervTv/wrf_docs_chinese/edit/master/wrf_technote/11.2 Improvements to the WRFDA Algorithm.md" target="_blank" rel="noopener noreferrer">帮助我们改善此页面！</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">3/26/2020, 10:29:41 AM</span></div></footer> <!----></main> <!----> <div style="display:none;" data-v-319dd33c data-v-319dd33c><div class="comments-wrapper" data-v-319dd33c><!----></div></div></div></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-a81d141e data-v-a81d141e><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-a81d141e><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-a81d141e></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-a81d141e></path></svg></div><div class="reading-progress top" data-v-21b39eda><div class="progress" data-v-21b39eda></div></div></div></div>
    <script src="/wrf/assets/js/app.22a32cd3.js" defer></script><script src="/wrf/assets/js/4.5baa2a83.js" defer></script><script src="/wrf/assets/js/1.dd1b2a2d.js" defer></script><script src="/wrf/assets/js/19.f5085d4a.js" defer></script>
  </body>
</html>
